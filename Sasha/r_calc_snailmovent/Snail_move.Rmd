---
title: "Snail_move"
output: html_document
date: "2023-09-30"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, warning = FALSE, message = FALSE)
```



```{r}
library(readxl)
library(ggplot2)
library(dplyr)
library(broom)
library(clipr)
library(cowplot)

```



```{r}
snail_move <- read_excel("Data/snail_movement_2023.xlsx", na = "NA")

snail_move$Speed <- snail_move$Trek_lenght/snail_move$active_time

Litt <- snail_move[snail_move$Species == "Littorina",]
Hydr <- snail_move[snail_move$Species == "Hydrobia",]

Barbar <- snail_move[snail_move$Barbarity == "Barbar",]
Domestic <- snail_move[snail_move$Barbarity == "domestic",]

Barbar_Litt <- Litt[Litt$Barbarity == "Barbar",]
Barbar_Hydr <- Hydr[Hydr$Barbarity == "Barbar",]
Domestic_Litt <- Litt[Litt$Barbarity == "domestic",]
Domestic_Hydr <- Hydr[Hydr$Barbarity == "domestic",]


snail_move  <- snail_move %>% filter(Barbarity == "Barbar")

setwd('H:/Text/Paper_2023/Sasha/r_calc_snailmovent/Data')
snail_move2 <- read_excel("snail_movement_2023_lenght.xlsx", na = "NA")

Litt2 <- snail_move2[snail_move2$Species == "Littorina",]
Hydr2 <- snail_move2[snail_move2$Species == "Hydrobia",]
```

# Материал и методика
## Сбор материалов
###### Работа проводилась на территории Кандалакшского заповедника на острове Ряжков. Непосредственный сбор материалов происходил на илисто-песчаной литорали Южной губы (координаты точки сбора 67.008560, 32.571260). 
###### Во время отлива мы собрали мидиевые друзы (небольшие скопления мидий, соединенных друг с другом биссусными нитями), и помещали их в пластиковые контейнеры. Каждая друза помещалась в отдельный сухой контейнер, который транспортировали в лабораторию.   Помимо сбора друз во время отлива в той же точке, в которой собрали друзы, собирали живых гидробий и литторин. Согласно исследованиям, А. Гафаровой (2019) в месте сбора материала могут встречаться как Peringia ulvae, так и Ecrobia ventrosa. Гидробий мы собирали, промывая горстки песка через сито с величиной ячеи 0.5 мм и помещая остававшихся в сите гидробий в пластиковый контейнер без воды. Литторин мы собирали с поверхности грунта и также помещали в отдельный пластиковый контейнер без воды. Отсутствие воды мы объясняем тем что действовали по проверенной методике, чтобы избежать непредвиденных погрешностей. После мы транспортировали эти контейнеры в лабораторию.
## Проведение эксперимента
###### В лаборатории мы доставали из контейнеров с друзами литторин и гидробий подвергшиеся биссусному прикреплению (далее мы будем называть их “Плененными”), а из контейнеров без друз мы доставали улиток, которые не подверглись биссусному прикреплению (далее “Свободные”). Потом мы сажали свободных или плененных литторин и гидробий в центр пластиковой палетки в контейнер с чистой морской водой и запускали секундомер. Если по прошествии 5 минут (300 секунд) улитка не начинала двигаться, то мы выключали таймер и записывали значение на секундомере (время старта), если улитка начинала движение раньше 5 минут, то мы так же записывали время старта и включали запись видео. Запись видео длилась 2 минуты (120 секунд), либо до тех пор, пока улитка не выползала за границы палетки. Запись видео была необходима, чтобы определить вариабельность продвижения и скорость улиток. Для работы с видео использовалась программа LevenhukLite.
## Статистическая обработка
###### В качестве зависимой переменной в статистическом анализе мы использовали время старта, время спустя которое улитка начинала двигаться, вариабельность продвижения, то насколько путь улитки был извилистым и скорость, отношение пройденного пути ко времени, затраченному на него. Для всех этих величин мы построили графики, описывающие связь зависимой переменной с статусом моллюска (свободный vs плененный). В модель также были включены взаимодействия этих двух предикторов.  В качестве порогового значения для отвержения нулевой гипотезы использовался уровень значимости α=0,05. Все расчеты проводились с использованием функций языка статистического программирования R 4.2.2 (R Core Team, 2023). 
# Результаты
###### Рисунок N демонстрирует связь всех пяти анализируемых факторов для гидробий в зависимости от их статуса. Дисперсионные анализы (Таблица 1 - 3) показали, что ни один из выше перечисленных факторов у гидробий не зависит от их размера и их статуса. 

```{r}
ggplot(Hydr2, aes(y = Value, x = Status, fill = Status)) + geom_boxplot() + theme_bw() + facet_wrap(~Trait,scales = "free_y")
```

###### Рисунок N. Зависимость вариабельности движения (левый график), скорости (средний график), время старта (правый график) от статуса моллюска (красный – “плененные”, синий – “свободные”) у гидробий
######                      Df Sum Sq Mean Sq F value Pr(>F)
###### Aperture_size         1     45    45.0   0.281  0.599
###### Status                1     19    18.6   0.116  0.735
###### Aperture_size:Status  1    336   336.1   2.097  0.154
###### Residuals            46   7372   160.3   
###### Sd
######                      Df Sum Sq Mean Sq F value Pr(>F)
###### Aperture_size         1   0.55  0.5549   0.646  0.426
###### Status                1   0.62  0.6155   0.717  0.402
###### Aperture_size:Status  1   0.59  0.5924   0.690  0.411
###### Residuals            46  39.50  0.8587 
###### Speed
######                      Df Sum Sq Mean Sq F value Pr(>F)
###### Aperture_size         1   8689    8689   0.879  0.351
###### Status                1  22621   22621   2.288  0.134
###### Aperture_size:Status  1    533     533   0.054  0.817
###### Residuals            97 958898    9886              
###### Turn_time

##### На рисунке N показана связь трех анализируемых нами факторов для литторин в зависимости от их статуса. Дисперсионные анализы (Таблицы 4 - 6) показали, что зависимости между размером устья и статусом моллюска для вариабельности продвижения и времени старта нет, в то время как для скорости отличия статистически значимы. Прикрепленные литторины двигаются с меньшей скоростью, чем свободные. В то же время для вариабельности пути и времени старта была выявлена связь с одним конкретным параметром – статусом моллюска.

```{r}
ggplot(Litt2, aes(y = Value, x = Status, fill = Status)) + geom_boxplot() + theme_bw() + facet_wrap(~Trait,scales = "free_y")
```

###### Рисунок N. Зависимость вариабельности движения (левый график), скорости (средний график), время старта (правый график) от статуса моллюска (красный – “плененные”, синий – “свободные”) у литторин 
######                      Df Sum Sq Mean Sq F value Pr(>F)  
###### Aperture_size         1     79    78.7   0.862 0.3596  
###### Status                1    393   393.2   4.304 0.0454 *
###### Aperture_size:Status  1    188   188.0   2.058 0.1603  
###### Residuals            35   3197    91.4    
###### Sd
######                      Df Sum Sq Mean Sq F value   Pr(>F)    
###### Aperture_size         1  70.90   70.90  37.326 5.54e-07 ***
###### Status                1   0.74    0.74   0.388   0.5376    
###### Aperture_size:Status  1   8.91    8.91   4.692   0.0372 *  
###### Residuals            35  66.49    1.90      
###### Speed
######                       Df  Sum Sq Mean Sq F value   Pr(>F)    
###### Aperture_size          1   19698   19698   1.869    0.174    
###### Status                 1  568006  568006  53.890 3.62e-11 ***
###### Aperture_size:Status   1    8338    8338   0.791    0.376    
###### Residuals            112 1180486   10540    
###### Turn_time

###### На рисунке N изображена зависимость скорости от размера устья улитки и от ее статуса. Видно, что значение скорости у свободных литторин увеличивается с увеличением размера, в то время как у плененных литторин значение скорости от размера не изменяется. Так же скорость у свободных и плененных литторин при небольшом размере совпадает.

```{r}
ggplot(Barbar, aes(y = Speed, x = Aperture_size, fill = Status, color = Status)) + geom_point() + geom_smooth(method = 'lm') + theme_bw()
```

###### Рисунок N. Зависимость скорости моллюска от размера устья и статуса у литторин (красный – “плененные”, синий – “свободные”)

# Обсуждение
###### Полученные нами результаты показывают, что гидробии подвергшиеся биссусному прикреплению почти не отличаются от гидробий свободных по всем пяти параметрам.
###### Литторины, которые подверглись биссусному прикреплению испытывали на себе негативное воздействие, из – за чего скорость и число пройденных квадратов у плененных литторин была статистически меньше чем у литторин, не подвергшихся биссусному прикреплению.
###### Полученные нами данные можно объяснить с помощью разных способов питания литторин и гидробий. Литторины питаются, соскабливая радулой микрообрастания с поверхности твердых субстратов (Otero-Schmitt 1977). Гидробии же собирают осадок с поверхности грунта (Lopez &amp; Levinton 1978). Если литторина подвергается прикреплению, то она может собирать микрообрастания только с небольшой площади, размер которой зависит от длины нитей биссуса, прикрепленных к раковине. Для гидробий же прикрепление биссусных нитей не так критично, поскольку могут питаться частицами осадка (Lopez &amp; Levinton 1978), хотя с увеличением размера им, вероятно, перестает хватать такой еды.
# Список литературы
###### Otero-Schmitt 1977
###### Lopez &amp; Levinton 1978
###### А. Гафаровой 2019
###### Беклемишев, В. Н. (1951). О классификации биоценологических (симфизиологических) связей. Бюлл. МОИП. Отд. биол, 56(5), 3-30.
###### Хайтов, В. М., & Артемьева, А. В. (2004). О взаимоотношениях двустворчатых моллюсков Mytilus edulis и гастропод Hydrobia ulvae на литорали Долгой губы о-ва Большого Соловецкого (Онежский залив Белого моря). Вестник Санкт-Петербургского Государственного университета. Серия 3 (Биология) (4), 35-41. 
###### R Core Team (2022). R: A language and environment for statistical computing. R  Foundation for Statistical Computing, Vienna, Austria. URL  https://www.R-project.org/.


